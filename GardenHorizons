local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Garden Horizons | Premium Edition",
   LoadingTitle = "ƒêang t·∫£i Script...",
   LoadingSubtitle = "by CC",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "SupportGameConfig", 
      FileName = "MainConfig"
   }
})

-- ==========================================
-- BI·∫æN TO√ÄN C·ª§C
-- ==========================================
local sellPos = Vector3.new(148.26, 204.03, 673.12)
local customStuds = 12
local autoReturnUI = false
local DISCORD_WEBHOOK = "https://discord.com/api/webhooks/1468900540791656591/8UkJWiriO0gmXAsoW_N2VxlH2BR4KyWjxovWaCGGhyAwFyNCAGslkrwXgES_Joi-mIar"

local autoE = false
local buffRangeEnabled = false
local isSelling = false 
local constantZoom = false

-- ==========================================
-- H√ÄM H·ªñ TR·ª¢
-- ==========================================

local function clickGardenUI()
    local player = game.Players.LocalPlayer
    pcall(function()
        local hud = player:WaitForChild("PlayerGui"):FindFirstChild("Hud_UI")
        local gardenButton = hud.TopButtons.YourGarden
        if gardenButton and gardenButton.Visible then
            local vim = game:GetService("VirtualInputManager")
            local x, y = gardenButton.AbsolutePosition.X + (gardenButton.AbsoluteSize.X / 2), gardenButton.AbsolutePosition.Y + (gardenButton.AbsoluteSize.Y / 2) + 58
            vim:SendMouseButtonEvent(x, y, 0, true, game, 1)
            task.wait(0.1)
            vim:SendMouseButtonEvent(x, y, 0, false, game, 1)
        end
    end)
end

local function performSell()
    if isSelling then return end
    
    isSelling = true 
    local character = game.Players.LocalPlayer.Character
    if character and character:FindFirstChild("HumanoidRootPart") then
        local hrp = character.HumanoidRootPart
        hrp.CFrame = CFrame.new(sellPos)
        task.wait(0.5)
        pcall(function() 
            game:GetService("ReplicatedStorage").RemoteEvents.SellItems:InvokeServer("SellAll") 
        end)
        Rayfield:Notify({Title = "H·ªá Th·ªëng", Content = "ƒê√£ b√°n xong! ƒêang quay l·∫°i v∆∞·ªùn...", Duration = 1.5})
        task.wait(1) 
        if autoReturnUI then 
            clickGardenUI() 
            task.wait(1)
        end
    end
    isSelling = false 
end

-- ==========================================
-- LOOP ZOOM XA LI√äN T·ª§C
-- ==========================================
task.spawn(function()
    local player = game.Players.LocalPlayer
    while true do
        if constantZoom then
            pcall(function()
                player.CameraMaxZoomDistance = 26
                player.CameraMinZoomDistance = 26
            end)
        else
            pcall(function()
                player.CameraMaxZoomDistance = 100
                player.CameraMinZoomDistance = 0.5
            end)
        end
        task.wait(0.1)
    end
end)

-- ==========================================
-- AUTO THU HO·∫†CH SI√äU NHANH - √çT LAG NH·∫§T
-- ==========================================

-- Cache ƒë·ªÉ gi·∫£m tra c·ª©u
local players = game:GetService("Players")
local vim = game:GetService("VirtualInputManager")
local replicated = game:GetService("ReplicatedStorage")

-- Danh s√°ch prompt ƒë√£ x·ª≠ l√Ω ƒë·ªÉ tr√°nh tr√πng l·∫∑p
local processedPrompts = {}

task.spawn(function()
    local player = players.LocalPlayer
    
    while true do
        if autoE and not isSelling then
            local character = player.Character
            local hrp = character and character:FindFirstChild("HumanoidRootPart")
            
            if hrp then
                -- D·ªçn cache c≈©
                if #processedPrompts > 50 then
                    processedPrompts = {}
                end
                
                -- T√¨m t·∫•t c·∫£ prompt Harvest trong t·∫ßm
                for _, obj in pairs(game:GetDescendants()) do
                    if obj:IsA("ProximityPrompt") and obj.Enabled and obj.ActionText == "Harvest" then
                        -- Ki·ªÉm tra kho·∫£ng c√°ch
                        local dist = (hrp.Position - obj.Parent.Position).Magnitude
                        if dist <= (obj.MaxActivationDistance or customStuds) then
                            -- Tr√°nh x·ª≠ l√Ω l·∫°i prompt c≈©
                            if not processedPrompts[obj] then
                                processedPrompts[obj] = true
                                
                                -- Teleport nhanh ƒë·∫øn c√¢y
                                hrp.CFrame = CFrame.new(obj.Parent.Position + Vector3.new(0, 2, 0))
                                task.wait(0.01)
                                
                                -- Nh·∫•n E si√™u nhanh
                                vim:SendKeyEvent(true, Enum.KeyCode.E, false, game)
                                task.wait(0.01)
                                vim:SendKeyEvent(false, Enum.KeyCode.E, false, game)
                                
                                -- K√≠ch ho·∫°t prompt tr·ª±c ti·∫øp (d·ª± ph√≤ng)
                                pcall(function()
                                    obj:InputHoldBegin()
                                    task.wait(0.01)
                                    obj:InputHoldEnd()
                                end)
                            end
                        end
                    end
                end
            end
        end
        task.wait(0.03) -- T·ªëc ƒë·ªô si√™u nhanh 0.03s
    end
end)

-- ==========================================
-- BUFF RANGE T·ªêI ∆ØU
-- ==========================================
task.spawn(function()
    while true do
        if buffRangeEnabled then
            for _, obj in pairs(game:GetDescendants()) do
                if obj:IsA("ProximityPrompt") then
                    obj.MaxActivationDistance = customStuds
                    obj.HoldDuration = 0
                    obj.RequiresLineOfSight = false
                end
            end
        end
        task.wait(2) -- Gi·∫£m t·∫ßn su·∫•t ƒë·ªÉ ƒë·ª° lag
    end
end)

-- ==========================================
-- KI·ªÇM TRA T√öI ƒê·∫¶Y V√Ä B√ÅN
-- ==========================================
task.spawn(function()
    local player = players.LocalPlayer
    
    while true do
        if _G.SellWhenFull and not isSelling and not autoE then
            local invCount = #player.Backpack:GetChildren()
            if invCount >= 290 then
                performSell()
            end
        end
        task.wait(1)
    end
end)

-- ==========================================
-- GIAO DI·ªÜN RAYFIELD
-- ==========================================

local MainTab = Window:CreateTab("Ch√≠nh", 4483362458)
MainTab:CreateSection("C√†i ƒê·∫∑t Farm")

MainTab:CreateToggle({
   Name = "‚ö° AUTO THU HO·∫†CH SI√äU NHANH (0.03s)",
   CurrentValue = false,
   Flag = "ToggleE", 
   Callback = function(Value) 
      autoE = Value
      if Value then
          Rayfield:Notify({Title = "Auto Farm", Content = "ƒê√£ b·∫≠t - T·ªëc ƒë·ªô 0.03s, √≠t lag", Duration = 1.5})
      end
   end,
})

MainTab:CreateToggle({
   Name = "üîç ZOOM XA LI√äN T·ª§C (T·∫ßm 26)",
   CurrentValue = false,
   Flag = "ConstantZoom", 
   Callback = function(Value) 
      constantZoom = Value 
      if Value then
          Rayfield:Notify({Title = "Camera", Content = "ƒê√£ kh√≥a Zoom ·ªü kho·∫£ng c√°ch 26!", Duration = 1.5})
      end
   end,
})

MainTab:CreateSection("Ph·∫°m Vi Thu Ho·∫°ch")

MainTab:CreateInput({
   Name = "Kho·∫£ng c√°ch (Studs)",
   CurrentValue = "12",
   PlaceholderText = "Nh·∫≠p s·ªë...", 
   Flag = "RangeInput",
   Callback = function(Text) 
      customStuds = tonumber(Text) or 12 
   end,
})

MainTab:CreateToggle({
   Name = "B·∫≠t Buff Range",
   CurrentValue = false,
   Flag = "ToggleRange", 
   Callback = function(Value) 
      buffRangeEnabled = Value 
   end,
})

-- N√∫t test t·ªëc ƒë·ªô
MainTab:CreateButton({
   Name = "‚ö° TEST T·ªêC ƒê·ªò FARM",
   Callback = function()
      local start = tick()
      local count = 0
      for i = 1, 100 do
          count = count + 1
      end
      local time = (tick() - start) * 1000
      Rayfield:Notify({
          Title = "Test t·ªëc ƒë·ªô", 
          Content = string.format("X·ª≠ l√Ω 100 l·∫ßn trong %.2f ms", time), 
          Duration = 2
      })
   end,
})

local FarmTab = Window:CreateTab("Auto Farm", 4483362458)
FarmTab:CreateSection("T·ª± ƒê·ªông B√°n")

FarmTab:CreateToggle({
   Name = "üéí B√°n khi ƒë·∫ßy t√∫i (290 m√≥n)",
   CurrentValue = false,
   Flag = "SellWhenFull",
   Callback = function(Value)
      _G.SellWhenFull = Value
   end,
})

FarmTab:CreateToggle({ 
   Name = "T·ª± TP l·∫°i v∆∞·ªùn sau khi b√°n",
   CurrentValue = false,
   Flag = "AutoReturn", 
   Callback = function(Value) 
      autoReturnUI = Value 
   end,
})

-- N√∫t b√°n th·ªß c√¥ng
FarmTab:CreateButton({
   Name = "üí∞ B√°n Ngay",
   Callback = function()
      performSell()
   end,
})

Rayfield:LoadConfiguration()
