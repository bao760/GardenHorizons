local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "SCJ Horizons V2.1",
   LoadingTitle = "Đang tự động tải cài đặt...",
   LoadingSubtitle = "by Gemini",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "SCJ_Horizons_Configs", 
      FileName = "MainConfig"
   },
   KeySystem = false, 
})

-- Tab 1: Info
local Tab1 = Window:CreateTab("Info", 4483362458)
Tab1:CreateSection("Thông tin Script")
Tab1:CreateLabel("Tên: SCJ Horizons V2.1")
Tab1:CreateLabel("Phiên bản: 2.1")
Tab1:CreateParagraph({Title = "Trạng thái", Content = "Script sẽ tự động ghi nhớ và tải lại các thiết lập của bạn."})

-- Tab 2: Main Functions
local Tab2 = Window:CreateTab("Main", 4483362458)

local _G = { AutoE = false }
local VirtualInputManager = game:GetService("VirtualInputManager")
local Player = game:GetService("Players").LocalPlayer

Tab2:CreateSection("Chức năng chính")

Tab2:CreateToggle({
   Name = "Auto E & Max Zoom Out",
   CurrentValue = false,
   Flag = "MainToggle_Config", 
   Callback = function(Value)
      _G.AutoE = Value
      
      if Value then
          -- 1. Xử lý Zoom Camera
          Player.CameraMaxZoomDistance = 10000 
          
          -- 2. Xử lý Auto E (Spam)
          task.spawn(function()
              Rayfield:Notify({
                 Title = "Đã kích hoạt",
                 Content = "Đang chạy Auto E và Max Zoom.",
                 Duration = 2,
                 Image = 4483362458,
              })
              
              while _G.AutoE do
                  VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.E, false, game)
                  task.wait(0.05)
                  VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)
                  task.wait(0.05)
              end
          end)
      else
          Player.CameraMaxZoomDistance = 20 -- Trả về mặc định khi tắt
          
          Rayfield:Notify({
             Title = "Đã tắt",
             Content = "Đã ngừng toàn bộ chức năng.",
             Duration = 2,
             Image = 4483362458,
          })
      end
   end,
})

-- Tự động tải lại trạng thái nút đã lưu từ trước
Rayfield:LoadConfiguration()
